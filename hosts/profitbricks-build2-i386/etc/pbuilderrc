# this is your configuration file for pbuilder.
# the file in /usr/share/pbuilder/pbuilderrc is the default template.
# /etc/pbuilderrc is the one meant for overwriting defaults in
# the default template
#
# read pbuilderrc.5 document for notes on specific options.
#
# cater for different locations
case $HOSTNAME in
	jenkins|jenkins-test-vm|profitbricks-build*)					MIRRORSITE=http://ftp.de.debian.org/debian ;;
	bbx15|bpi0|cbxi4*|cb3*|hb0|wbq0|odxu4*|odu3*|wbd0|rpi2*|ff2*|ff4*|opi2*)	MIRRORSITE=http://ftp.us.debian.org/debian ;;
	*)										echo "unsupported host, exiting." ; exit 1 ;;
esac
# only use eatmydata on armhf+i386 - on amd64 we build in tmpfs anyway
case $HOSTNAME in
	profitbricks-build*i386)
		EATMYDATA=yes ;;
	bbx15|bpi0|cbxi4*|cb3*|hb0|wbq0|odxu4*|odu3*|wbd0|rpi2*|ff2*|ff4*|opi2*)
		EATMYDATA=yes ;;
	*)	;;
esac
EXTRAPACKAGES=""	# better list them in bin/reproducible_setup_pbuilder.sh
APTCACHE=""
COMPRESSPROG="pigz"
BUILDPLACE=/srv/workspace/pbuilder  # build in /srv/workspace, which is in tmpfs
# unset proxy, see #780587
unset http_proxy
export -n http_proxy
# there are software wanting /dev/shm writable, so give them so. There are tons
# of bug shm related in pbuilder, that's just a workaround for all of them.
# /run/shm is already mounted as a tmpfs by default.
BINDMOUNTS="/dev/shm"
# set PATH to predictable values, see #780729 and #780725
PATH="/usr/sbin:/usr/bin:/sbin:/bin:/usr/games"

# used for reproducible builds tests, when doing the 2nd build
if [ "$(readlink /proc/1/ns/uts)" != "$(readlink /proc/self/ns/uts)" ]; then
	PATH="/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/i/capture/the/path"
fi

# needed to ignore failures due to running 398 days in the future…
# (only on those 2 nodes running in the future…)
if [ "$HOSTNAME" = "profitbricks-build5-amd64" ] || [ "$HOSTNAME" = "profitbricks-build6-i386" ] ; then
	case "$PBUILDER_OPERATION" in
		create)
			APTGETOPT=(-o Acquire::Check-Valid-Until="false")
			;;
		*)	;;
	esac
fi
