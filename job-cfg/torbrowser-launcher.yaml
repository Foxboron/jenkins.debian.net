- defaults:
    name: torbrowser-launcher_setup
    project-type: freestyle
    triggers:
      - timed: '{my_timed}'
    properties:
      - sidebar:
          url: https://jenkins.debian.net/userContent/about.html
          text: About jenkins.debian.net
          icon: /userContent/images/debian-swirl-24x24.png
      - sidebar:
          url: https://jenkins.debian.net/view/torbrowser-launcher
          text: torbrowser-launcher builds jobs
          icon: /userContent/images/debian-jenkins-24x24.png
      - sidebar:
          url: http://www.profitbricks.co.uk
          text: Sponsored by Profitbricks
          icon: /userContent/images/profitbricks-24x24.png
    description: '{my_description}<br>Job configuration source is <a href="http://anonscm.debian.org/cgit/qa/jenkins.debian.net.git/tree/job-cfg/torbrowser-launcher.yaml">torbrowser-launcher.yaml</a>.<br>Results are available at <a href="https://torbrowser-launcher.debian.net/">https://torbrowser-launcher.debian.net</a>.'
    logrotate:
      daysToKeep: 90
      numToKeep: 30
      artifactDaysToKeep: -1
      artifactNumToKeep: -1
    builders:
      - shell: '{my_shell}'
    publishers:
      - logparser:
          parse-rules: '/srv/jenkins/logparse/torbrowser-launcher.rules'
          unstable-on-warning: 'true'
          fail-on-error: 'true'
      - email:
          recipients: '{my_recipients}'
    node: '{my_node}'

- defaults:
    name: torbrowser-launcher_git
    project-type: freestyle
    triggers:
      - pollscm: '*/6 * * * *'
      - timed: '{my_timed}'
    properties:
      - sidebar:
          url: https://jenkins.debian.net/userContent/about.html
          text: About jenkins.debian.net
          icon: /userContent/images/debian-swirl-24x24.png
      - sidebar:
          url: https://jenkins.debian.net/view/torbrowser-launcher
          text: torbrowser-launcher jobs
          icon: /userContent/images/debian-jenkins-24x24.png
      - sidebar:
          url: http://www.profitbricks.co.uk
          text: Sponsored by Profitbricks
          icon: /userContent/images/profitbricks-24x24.png
      - throttle:
          max-total: 3
          max-per-node: 1
          enabled: true
          option: category
          categories:
            - torbrowser-launcher
    description: '{my_description}<br>Job configuration source is <a href="http://anonscm.debian.org/cgit/qa/jenkins.debian.net.git/tree/job-cfg/torbrowser-launcher.yaml">torbrowser-launcher.yaml</a>.<br>Results are available at <a href="https://torbrowser-launcher.debian.net/">https://torbrowser-launcher.debian.net</a>.'
    logrotate:
      daysToKeep: 90
      numToKeep: 20
      artifactDaysToKeep: -1
      artifactNumToKeep: -1
    builders:
      - shell: '{my_shell} {my_gitbranch}'
    publishers:
      - logparser:
          parse-rules: '/srv/jenkins/logparse/torbrowser-launcher.rules'
          unstable-on-warning: 'true'
          fail-on-error: 'true'
      - archive:
          artifacts: 'results/*.*'
          latest_only: false
      - imagegallery:
          title: '{my_description}'
          includes: 'results/screenshot_*.png'
          image-width: 300
      - email:
          recipients: '{my_recipients}'
    wrappers:
      - live-screenshot
    scm:
      - git:
          url: '{my_gitrepo}'
          branches:
            - '{my_gitbranch}'
    node: '{my_node}'

- defaults:
    name: torbrowser-launcher_packages
    project-type: freestyle
    triggers:
      - timed: '{my_timed}'
    properties:
      - sidebar:
          url: https://jenkins.debian.net/userContent/about.html
          text: About jenkins.debian.net
          icon: /userContent/images/debian-swirl-24x24.png
      - sidebar:
          url: https://jenkins.debian.net/view/torbrowser-launcher
          text: torbrowser-launcher jobs
          icon: /userContent/images/debian-jenkins-24x24.png
      - sidebar:
          url: http://www.profitbricks.co.uk
          text: Sponsored by Profitbricks
          icon: /userContent/images/profitbricks-24x24.png
      - throttle:
          max-total: 3
          max-per-node: 1
          enabled: true
          option: category
          categories:
            - torbrowser-launcher
    description: '{my_description}<br>Job configuration source is <a href="http://anonscm.debian.org/cgit/qa/jenkins.debian.net.git/tree/job-cfg/torbrowser-launcher.yaml">torbrowser-launcher.yaml</a>.<br>Results are available at <a href="https://torbrowser-launcher.debian.net/">https://torbrowser-launcher.debian.net</a>.'
    logrotate:
      daysToKeep: 90
      numToKeep: 20
      artifactDaysToKeep: -1
      artifactNumToKeep: -1
    builders:
      - shell: '{my_shell}'
    publishers:
      - logparser:
          parse-rules: '/srv/jenkins/logparse/torbrowser-launcher.rules'
          unstable-on-warning: 'true'
          fail-on-error: 'true'
      - archive:
          artifacts: 'results/*.*'
          latest_only: false
      - imagegallery:
          title: '{my_description}'
          includes: 'results/screenshot_*.png'
          image-width: 300
      - email:
          recipients: '{my_recipients}'
    wrappers:
      - live-screenshot
    node: '{my_node}'


- job-template:
    defaults: torbrowser-launcher_setup
    name: '{name}_setup_schroot_unstable_amd64'

- job-template:
    defaults: torbrowser-launcher_setup
    name: '{name}_setup_schroot_stretch_amd64'

- job-template:
    defaults: torbrowser-launcher_setup
    name: '{name}_setup_schroot_jessie_amd64'

- job-template:
    defaults: torbrowser-launcher_setup
    name: '{name}_setup_schroot_wheezy_amd64'

- job-template:
    defaults: torbrowser-launcher_packages
    name: '{name}_test_on_experimental_amd64'
    disabled: true

- job-template:
    defaults: torbrowser-launcher_packages
    name: '{name}_test_on_unstable_amd64'

- job-template:
    defaults: torbrowser-launcher_git
    name: '{name}_test_on_unstable_amd64_from_git_branch_debian_sid'

- job-template:
    defaults: torbrowser-launcher_git
    name: '{name}_test_on_unstable_amd64_from_git_branch_debian_experimental'
    disabled: true

- job-template:
    defaults: torbrowser-launcher_git
    name: '{name}_test_on_unstable_amd64_from_git_branch_upstream_master'

- job-template:
    defaults: torbrowser-launcher_packages
    name: '{name}_test_on_stretch_amd64'

- job-template:
    defaults: torbrowser-launcher_packages
    name: '{name}_test_on_stretch_amd64_from_unstable'

- job-template:
    defaults: torbrowser-launcher_git
    name: '{name}_test_on_stretch_amd64_from_git_branch_debian_sid'

- job-template:
    defaults: torbrowser-launcher_packages
    name: '{name}_test_on_jessie_amd64'

- job-template:
    defaults: torbrowser-launcher_packages
    name: '{name}_test_on_jessie_amd64_from_backports'

- job-template:
    defaults: torbrowser-launcher_packages
    name: '{name}_test_on_jessie_amd64_from_stretch'

- job-template:
    defaults: torbrowser-launcher_packages
    name: '{name}_test_on_jessie_amd64_from_unstable'

- job-template:
    defaults: torbrowser-launcher_packages
    name: '{name}_test_on_jessie_amd64_from_experimental'
    disabled: true

- job-template:
    defaults: torbrowser-launcher_git
    name: '{name}_test_on_jessie_amd64_from_git_branch_debian_experimental'
    disabled: true

- job-template:
    defaults: torbrowser-launcher_git
    name: '{name}_test_on_jessie_amd64_from_git_branch_debian_sid'

- job-template:
    defaults: torbrowser-launcher_git
    name: '{name}_test_on_jessie_amd64_from_git_branch_debian_jessie'

- job-template:
    defaults: torbrowser-launcher_git
    name: '{name}_test_on_jessie_amd64_from_git_branch_debian_sid_with_broken_config'

- job-template:
    defaults: torbrowser-launcher_git
    name: '{name}_test_on_jessie_amd64_from_git_branch_debian_jessie_with_broken_config'

- job-template:
    defaults: torbrowser-launcher_packages
    name: '{name}_test_on_wheezy_amd64_from_backports'

- project:
    name: torbrowser-launcher
    jobs:
        - '{name}_setup_schroot_unstable_amd64':
            my_description: 'Setup unstable/amd64 schroot for testing torbrowser-launcher.'
            my_timed: '42 1 * * *'
            my_shell: '/srv/jenkins/bin/schroot-create.sh torbrowser-launcher torbrowser-launcher-unstable unstable torbrowser-launcher ca-certificates awesome dbus xterm x11-utils x11-xserver-utils feh libnotify-bin figlet build-essential fakeroot devscripts python-all debhelper dh-apparmor lsb-release iceweasel'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_setup_schroot_stretch_amd64':
            my_description: 'Setup stretch/amd64 schroot for testing torbrowser-launcher.'
            my_timed: '42 2 * * *'
            my_shell: '/srv/jenkins/bin/schroot-create.sh torbrowser-launcher torbrowser-launcher-stretch stretch torbrowser-launcher ca-certificates awesome dbus xterm x11-utils x11-xserver-utils feh libnotify-bin figlet build-essential fakeroot devscripts python-all debhelper dh-apparmor lsb-release iceweasel'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_setup_schroot_jessie_amd64':
            my_description: 'Setup jessie/amd64 schroot for testing torbrowser-launcher.'
            my_timed: '42 3 * * *'
            my_shell: '/srv/jenkins/bin/schroot-create.sh torbrowser-launcher torbrowser-launcher-jessie jessie torbrowser-launcher ca-certificates awesome dbus xterm x11-utils x11-xserver-utils feh libnotify-bin figlet build-essential fakeroot devscripts python-all debhelper dh-apparmor lsb-release iceweasel'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_setup_schroot_wheezy_amd64':
            my_description: 'Setup wheezy/amd64 schroot for testing torbrowser-launcher.'
            my_timed: '42 4 * * 2'
            my_shell: '/srv/jenkins/bin/schroot-create.sh torbrowser-launcher torbrowser-launcher-wheezy wheezy ca-certificates awesome dbus xterm x11-utils x11-xserver-utils feh libnotify-bin figlet build-essential fakeroot devscripts python-all debhelper dh-apparmor lsb-release iceweasel python python-gtk2 python-psutil python-twisted python-lzma gnupg wmctrl tor'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_experimental_amd64':
            my_description: 'Test torbrowser-launcher from and on experimental/amd64.'
            my_timed: '23 2 * * *'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh experimental'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_unstable_amd64':
            my_description: 'Test torbrowser-launcher from and on unstable/amd64.'
            my_timed: '23 2 * * *'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh unstable'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_unstable_amd64_from_git_branch_debian_sid':
            my_description: 'Test torbrowser-launcher on unstable/amd64 using the branch debian/sid.'
            my_timed: '23 2 1 * *'
            my_gitrepo: 'git://git.debian.org/git/collab-maint/torbrowser-launcher.git'
            my_gitbranch: 'debian/sid'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh unstable git'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_unstable_amd64_from_git_branch_debian_experimental':
            my_description: 'Test torbrowser-launcher on unstable/amd64 using the branch debian/experimental.'
            my_timed: '23 2 1 * *'
            my_gitrepo: 'git://git.debian.org/git/collab-maint/torbrowser-launcher.git'
            my_gitbranch: 'debian/experimental'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh unstable git'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_unstable_amd64_from_git_branch_upstream_master':
            my_description: 'Test torbrowser-launcher on unstable/amd64 using the upstream master branch, in which the debian/sid branch is merged into.'
            my_timed: '23 2 * * *'
            my_gitrepo: 'git://github.com/micahflee/torbrowser-launcher'
            my_gitbranch: 'master'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh unstable git merge debian/sid'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_stretch_amd64':
            my_description: 'Test torbrowser-launcher from and on stretch/amd64.'
            my_timed: '23 3 * * *'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh stretch'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_stretch_amd64_from_unstable':
            my_description: 'Test torbrowser-launcher from unstable on stretch/amd64.'
            my_timed: '23 3 * * 2'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh stretch unstable'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_stretch_amd64_from_git_branch_debian_sid':
            my_description: 'Test torbrowser-launcher on stretch/amd64 using the branch debian/sid.'
            my_timed: '23 3 1 * *'
            my_gitrepo: 'git://git.debian.org/git/collab-maint/torbrowser-launcher.git'
            my_gitbranch: 'debian/sid'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh stretch git'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_jessie_amd64':
            my_description: 'Test torbrowser-launcher from and on jessie/amd64.'
            my_timed: '23 4 * * *'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh jessie'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_jessie_amd64_from_backports':
            my_description: 'Test torbrowser-launcher from backports on jessie/amd64.'
            my_timed: '23 4 * * 2'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh jessie backports'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_jessie_amd64_from_stretch':
            my_description: 'Test torbrowser-launcher from stretch on jessie/amd64.'
            my_timed: '23 4 * * 2'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh jessie stretch'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_jessie_amd64_from_unstable':
            my_description: 'Test torbrowser-launcher from unstable on jessie/amd64.'
            my_timed: '23 4 * * 2'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh jessie unstable'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_jessie_amd64_from_experimental':
            my_description: 'Test torbrowser-launcher from experimental on jessie/amd64.'
            my_timed: '23 4 * * 2'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh jessie experimental'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_jessie_amd64_from_git_branch_debian_experimental':
            my_description: 'Test torbrowser-launcher on jessie/amd64 using the branch debian/experimental.'
            my_timed: '23 4 1 * *'
            my_gitrepo: 'git://git.debian.org/git/collab-maint/torbrowser-launcher.git'
            my_gitbranch: 'debian/experimental'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh jessie git'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_jessie_amd64_from_git_branch_debian_sid':
            my_description: 'Test torbrowser-launcher on jessie/amd64 using the branch debian/sid.'
            my_timed: '23 4 1 * *'
            my_gitrepo: 'git://git.debian.org/git/collab-maint/torbrowser-launcher.git'
            my_gitbranch: 'debian/sid'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh jessie git'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_jessie_amd64_from_git_branch_debian_jessie':
            my_description: 'Test torbrowser-launcher on jessie/amd64 using the branch debian/jessie.'
            my_timed: '23 4 1 * *'
            my_gitrepo: 'git://git.debian.org/git/collab-maint/torbrowser-launcher.git'
            my_gitbranch: 'debian/jessie'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh jessie git'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_jessie_amd64_from_git_branch_debian_sid_with_broken_config':
            my_description: 'Test torbrowser-launcher with a broken user configuration on jessie/amd64 using the branch debian/sid.'
            my_timed: '23 4 1 * *'
            my_gitrepo: 'git://git.debian.org/git/collab-maint/torbrowser-launcher.git'
            my_gitbranch: 'debian/sid'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh broken_config jessie git'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_jessie_amd64_from_git_branch_debian_jessie_with_broken_config':
            my_description: 'Test torbrowser-launcher with a broken user configuration on jessie/amd64 using the branch debian/jessie.'
            my_timed: '23 4 1 * *'
            my_gitrepo: 'git://git.debian.org/git/collab-maint/torbrowser-launcher.git'
            my_gitbranch: 'debian/jessie'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh broken_config jessie git'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''
        - '{name}_test_on_wheezy_amd64_from_backports':
            my_description: 'Test torbrowser-launcher from backports on wheezy/amd64.'
            my_timed: '23 5 * * 2'
            my_shell: '/srv/jenkins/bin/test_torbrowser-launcher.sh wheezy backports'
            my_recipients: 'holger@layer-acht.org'
            my_node: ''

